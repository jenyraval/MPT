<?php
   include('session.php');
   include('config.php');
 ?>  
<html>
   
   <head>
      <title>Welcome </title>
	<img src="header.jpg" style="width:100%;height:300px;">
   </head>
   </head>
    <style>
   .navbar a:hover {
  background: #ddd;
  color: black;
}
.navbar a {
  float: left;
  display: block;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}
.navbar {
  overflow: hidden;
  background-color: #333;
  top: 0;
  width: 100%;
}
input[type=text], select {
  width: 70%;
  padding: 12px 20px;
  margin: 8px 0;
  display: inline-block;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}
textarea {
   padding: 12px 20px;
  margin: 8px 0;
  display: inline-block;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}
input[type=submit] {
  width: 70%;
  background-color: #000000;
  color: white;
  padding: 14px 20px;
  margin: 8px 0;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
   </style>

   <body>
	  
	  <div class="navbar">
  <a href="assets.php">Assets</a>
	<a href="pentest.php">Pentests</a> 
  <a href="tracker.php">Issue Tracker</a> 
  <a href="devloper.php">Developer's Corner</a>
   <a href="analytics.php">Analytics</a>
   <a href="logout.php">Logout</a>
	</div> 

<form method="post" action=""><br/>
*Select Asset: <br/>
<select name="assetname">
	<?php 
	$query = "select id,title from asset";
	$prepared = $db->prepare($query);
$prepared->execute();
$result = $prepared->get_result();

 while($data = $result->fetch_assoc())
{
  $val = $data['title'];
 echo "<option value='$val'>" . $data['title'] . "</option>";
}?>
</select><br/>
Targets (List of URIs,Thick clients,IP ranges): <br/>
 <textarea name="targets" rows="3" cols="143"></textarea><br/>
 Methodology: <br/>
<select name="type">
   <option value="Web">Web</option>
   <option value="API">API</option>
   <option value="Network">Network</option>
   <option value="WebAPI">Web+API</option>
   <option value="MobileApp">Mobile App</option>
   <option value="ConfigReview">Config Review</option>
   <option value="Phishing">Phishing</option>
   <option value="WebMobile">Web+Mobile</option> 
</select><br/> 
Testing Focus(OWASP top 10,ASVS,Business logic,Log4j etc): <br/>
<input type=text name="focus"><br/>
Credentials: <br/>
<input type="radio" name="creds" value="SignUp & Create">
 <label for="signup">SignUp & Create</label><br>
<input type="radio" name="creds" value="Connect with SPOC for credentials"> 
<label for="spoc">Connect with SPOC for credentials</label><br>
<input type="radio" name="creds" value="No Authentication Required"> 
<label for="noauth">No Authentication Required</label><br><br>
Include User Roles and Previleges Information: <br/>
<input type=text name="roles"><br/>
Instrction/Notes/Knowledge Transfer: <br/>
<input type=text name="notes"><br/>
Technology Stack: <br/>
<input type=text name="tech"><br/>
Target Enviornment: <br/>
<select name="env">
<option value="prod">Production</option>
<option value="preprod">Pre-Production</option>
<option value="qa">QA</option>
</select><br/>
Whitelisting Needed(WAF/NAC):<br/>
<input type="radio" name="whitelisting" value="Yes">
<label for="Yes">Yes</label><br>
<input type="radio" name="whitelisting" value="No">
<label for="No">No</label><br>
Sensitive Business Functions: <br/>
<input type=text name="sens"><br/>
Is it fine to DoS and/or Bruteforce: <br/>
<input type=text name="sens"><br/>
Test Data: <br/>
<input type=text name="testdata"><br/>
<label for="StartDate">Estimated Start Date:</label>
  <input type="date" id="startdate" name="startdate">&nbsp;&nbsp;
  <label for="EndDate">Estimated End Date:</label>
    <input type="date" id="enddate" name="enddate"><br/>
    Scope: <br/>
<select name="coverage">
<option value="Default">Default</option>
<option value="Timebound">Time bound</option>
<option value="Extensive">Extensive</option> 
</select><br/>
Asset Size <br/>
<select name="size">
<option value="Small">< 30 endpoints</option>
<option value="Medium">< 50 endpoints</option>
<option value="Large">60+ endpoints</option> 
</select><br/>
<input type="submit" name="submit" value="Create Pentest">
</form>
  </body>  
</html>
<?php 
if (!empty($_POST)){
$assetname = mysqli_real_escape_string($db,$_POST['assetname']);
$targets = mysqli_real_escape_string($db,$_POST['targets']);
$type = mysqli_real_escape_string($db,$_POST['type']);
$focus = mysqli_real_escape_string($db,$_POST['focus']);
$creds = mysqli_real_escape_string($db,$_POST['creds']);
$roles = mysqli_real_escape_string($db,$_POST['roles']);
$notes = mysqli_real_escape_string($db,$_POST['notes']);
$tech = mysqli_real_escape_string($db,$_POST['tech']);
$env = mysqli_real_escape_string($db,$_POST['env']);
$whitelisting = mysqli_real_escape_string($db,$_POST['whitelisting']);
$sens = mysqli_real_escape_string($db,$_POST['sens']);
$startdate = mysqli_real_escape_string($db,$_POST['startdate']);
$enddate = mysqli_real_escape_string($db,$_POST['enddate']);
$coverage = mysqli_real_escape_string($db,$_POST['coverage']);
$size = mysqli_real_escape_string($db,$_POST['size']);

$query = "insert into pentest(assetname,targets,type,focus,creds,roles,notes,tech,env,whitelisting,sens,startdate,enddate,scope,size) values ('$assetname','$targets','$type','$focus','$creds','$roles','$notes','$tech','$env','$whitelisting','$sens','$startdate','$enddate','$coverage','$size');";
if(mysqli_query($db,$query)){
   echo "<h3>Pentest created successfully.</h3>";
}
}
?>